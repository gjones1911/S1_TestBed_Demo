# ========================================================================
# üèÜ Production-Ready Mosquitto Configuration
# ========================================================================

# ===========================
# üîê Authentication & Security
# ===========================

# Allow anonymous connections? (Disable for security)
allow_anonymous false

# Password file for authentication (must be created using mosquitto_passwd)
# `mosquitto_passwd -c /mosquitto/config/passwords.txt mos_user`
#       pwdformosMQTT
password_file /mosquitto/config/passwords.txt

# Enable TLS for secure communication (Optional)
# Uncomment the following lines if you have valid SSL certificates
# listener 8883
# cafile /mosquitto/config/ca.crt
# certfile /mosquitto/config/server.crt
# keyfile /mosquitto/config/server.key

# ===========================
# üåê Listeners & Protocols
# ===========================

# Default MQTT listener (port 1883)
listener 1883

# WebSocket support on port 9001 (for browser-based MQTT clients)
listener 9001
protocol websockets

# ===========================
# üíæ Persistence & Data Storage
# ===========================

# Enable persistence to store subscriptions & messages between restarts
persistence true
persistence_location /mosquitto/data/

# How often to save persistent data (in seconds)
autosave_interval 1800

# ===========================
# üìñ Logging & Debugging
# ===========================

# Log file location
log_dest file /mosquitto/log/mosquitto.log

# Log types (Possible values: debug, error, warning, notice, information)
log_type error
log_type warning
log_type notice
log_type information

# Include client connection/disconnection events in the log
connection_messages true

# ===========================
# üì° Performance Tuning
# ===========================

# Set max number of allowed connections (adjust based on system capacity)
max_connections 1000

# Keep clients connected longer before disconnecting (default: 60)
keepalive_interval 300

# Message queue limits to prevent memory overload
queue_qos0_messages 1000
queue_qos1_messages 1000
queue_qos2_messages 1000

# ===========================
# üîÑ Bridge Configuration (Optional)
# ===========================
# If you need to connect this broker to another MQTT broker, configure a bridge.
# Example:
# connection bridge_to_another_broker
# address another-broker.example.com:1883
# topic # out 0
# topic # in 0
